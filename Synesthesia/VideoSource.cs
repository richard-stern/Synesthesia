using AForge.Video;
using AForge.Video.DirectShow;
using System;

//------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------
public class VideoSource
{
	VideoCaptureDevice m_VideoDevice = null;
	private string m_szID = "";
	private string m_szName = "";

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public VideoSource(string szName, string szID)
	{
		m_VideoDevice = new VideoCaptureDevice(szID);
		m_szName = szName;
		m_szID = szID;
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public void SetFrameEventCallback(NewFrameEventHandler handler)
	{
		if(m_VideoDevice != null)
			m_VideoDevice.NewFrame += new NewFrameEventHandler(handler);
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public void Start()
	{
		if(m_VideoDevice != null)
			m_VideoDevice.Start();
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public void Stop()
	{
		if(m_VideoDevice != null)
			m_VideoDevice.SignalToStop();
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public string GetName()
	{
		return m_szName;
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public void SetName(string szName)
	{
		m_szName = szName;
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public bool GetIsRunning()
	{
		return m_VideoDevice.IsRunning;
	}

	//------------------------------------------------------------------------------------
	//------------------------------------------------------------------------------------
	public override string ToString()
	{
		return GetName();
	}
}